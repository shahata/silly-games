import"./modulepreload-polyfill-B5Qt9EMX.js";const s={LOST:"lost",WON:"won",PLAYING:"playing"};function p(e){return Math.floor(Math.random()*e)}function E(e,t,f){function r(c,h){return c.some(function(m){return angular.equals(m,h)})}for(var l=[];l.length!==f;){var o={row:p(e),column:p(t)};r(l,o)||l.push(o)}return l}function L(e,t){return{count:0,mine:!1,revealed:!1,flagged:!1,coord:e,$autoReveal:function(){this.revealed&&(t||angular.noop)(this,!0)},$reveal:function(){!this.revealed&&!this.flagged&&(this.revealed=!0,(t||angular.noop)(this))},$flag:function(){this.revealed||(this.flagged=!this.flagged)},$displayValue:function(){return this.mine?"*":this.count?this.count:""}}}function M(e,t,f){var r,l=this;function o(n){var i=[];function a(v,u){var g=n.row+v,d=n.column+u;r[g]&&r[g][d]&&i.push(r[g][d])}return a(-1,-1),a(-1,0),a(-1,1),a(0,-1),a(0,1),a(1,-1),a(1,0),a(1,1),i}function c(){return r.reduce(function(n,i){return n.concat(i)},[])}function h(){c().forEach(function(n){n.revealed=!0})}function m(n){l.state=n,h()}function A(n,i){if(n.mine){m(s.LOST);return}if(i){var a=o(n.coord);a.filter(function(u){return u.flagged}).length>=n.count&&a.forEach(function(u){u.$reveal()})}else n.count===0&&o(n.coord).forEach(function(u){u.$reveal()});var v=c().every(function(u){return u.revealed||u.mine});v&&m(s.WON)}function N(){E(e,t,f).forEach(function(n){r[n.row][n.column].mine=!0,o(n).forEach(function(i){i.count++})})}function O(){r=[];for(var n=0;n<e;n++){r.push([]);for(var i=0;i<t;i++)r[n].push(new L({row:n,column:i},A))}}O(),N(),this.game=r,this.state=s.PLAYING}function w(e,t){e.parameters={rows:10,columns:10,mines:15},e.restart=function(){e.minefield=new M(parseInt(e.parameters.rows),parseInt(e.parameters.columns),parseInt(e.parameters.mines))},e.$watch("minefield.state",function(f){e.$evalAsync(function(){f===s.LOST?t.alert("You Lost!"):f===s.WON&&t.alert("You Won!")})}),e.restart()}w.$inject=["$scope","$window"];function C(e){return{restrict:"A",link:function(t,f,r){var l=e(r.onContextmenu);f.on("contextmenu",function(o){t.$apply(function(){o.preventDefault(),l(t,{$event:o})})})}}}C.$inject=["$parse"];angular.module("minesweeperApp",[]).controller("MinesweeperCtrl",w).directive("onContextmenu",C);
